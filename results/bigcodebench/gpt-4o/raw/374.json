{
  "task_id": "BigCodeBench/374",
  "instruct_prompt": "Protects all double quotes in all Excel (.xlsx) files in the specified directory by prefixing them with a double backslash.\nThe function should output with:\n    int: The number of Excel files processed.\nYou should write self-contained code starting with:\n```\nimport regex as re\nimport glob\nimport os\nfrom openpyxl import load_workbook\ndef task_func(directory_path='./xlsx_files/'):\n```",
  "llm_response": "import regex as re\nimport glob\nimport os\nfrom openpyxl import load_workbook\ndef task_func(directory_path='./xlsx_files/'):\n    # Get all Excel files in the specified directory\n    excel_files = glob.glob(os.path.join(directory_path, '*.xlsx'))\n    files_processed = 0\n\n    for file_path in excel_files:\n        # Load the workbook\n        workbook = load_workbook(file_path)\n        modified = False\n\n        # Iterate through all sheets\n        for sheet in workbook.worksheets:\n            # Iterate through all rows and columns\n            for row in sheet.iter_rows():\n                for cell in row:\n                    if isinstance(cell.value, str):\n                        # Protect double quotes by prefixing with double backslash\n                        new_value = re.sub(r'\"', r'\\\\\"', cell.value)\n                        if new_value != cell.value:\n                            cell.value = new_value\n                            modified = True\n\n        # Save the workbook if any modifications were made\n        if modified:\n            workbook.save(file_path)\n            files_processed += 1\n\n    return files_processed",
  "model": "gpt-4o"
}