{
  "task_id": "BigCodeBench/583",
  "instruct_prompt": "Generates an RSA public and private key pair and saves the private key in a file after encrypting it with a password using AES encryption. Returns the public key and the filename of the encrypted private key, along with encryption details for testing. The name of the output file is a in the format of \"private_key_<number>.txt\", where <number> is a the hex representation of the 8 randomly generated bytes.\nThe function should output with:\n    rsa.PublicKey: The RSA public key.\n    str: The filename where the encrypted private key is stored.\n    bytes: The encryption password, for testing decryption.\n    bytes: The encryption nonce, for testing decryption.\nYou should write self-contained code starting with:\n```\nimport rsa\nimport os\nfrom Crypto.Random import get_random_bytes\nfrom Crypto.Cipher import AES\nfrom base64 import b64encode, b64decode\ndef task_func():\n```",
  "llm_response": "import rsa\nimport os\nfrom Crypto.Random import get_random_bytes\nfrom Crypto.Cipher import AES\nfrom base64 import b64encode, b64decode\ndef task_func():\n    # Generate RSA key pair\n    (pub_key, priv_key) = rsa.newkeys(2048)\n    \n    # Serialize private key to PEM format\n    priv_key_pem = priv_key.save_pkcs1(format='PEM')\n    \n    # Generate encryption password and nonce\n    password = get_random_bytes(32)  # AES-256 key\n    nonce = get_random_bytes(16)     # AES nonce\n    \n    # Encrypt private key with AES in GCM mode\n    cipher = AES.new(password, AES.MODE_GCM, nonce=nonce)\n    ciphertext, tag = cipher.encrypt_and_digest(priv_key_pem)\n    \n    # Create filename with random hex number\n    random_bytes = get_random_bytes(8)\n    hex_number = random_bytes.hex()\n    filename = f\"private_key_{hex_number}.txt\"\n    \n    # Write encrypted data to file (nonce + tag + ciphertext)\n    with open(filename, 'wb') as f:\n        f.write(nonce)\n        f.write(tag)\n        f.write(ciphertext)\n    \n    return pub_key, filename, password, nonce",
  "model": "deepseek-chat-v3-0324"
}