{
  "task_id": "BigCodeBench/678",
  "instruct_prompt": "Processes JSON files in a directory. The function reads each JSON file alphabetically into a DataFrame and inserts a \"Source\" column that specifies the filename. The processed files are then moved to a \"processed\" subdirectory. The path may not exist initially.\nThe function should output with:\n    df (pandas.DataFrame): A DataFrame containing the data from all processed files.\nYou should write self-contained code starting with:\n```\nimport pandas as pd\nimport json\nimport os\nimport shutil\ndef task_func(path):\n```",
  "llm_response": "import pandas as pd\nimport json\nimport os\nimport shutil\ndef task_func(path):\n    \"\"\"\n    Processes JSON files in a directory, adding a 'Source' column with the filename,\n    and moves processed files to a 'processed' subdirectory.\n\n    Args:\n        path (str): Path to the directory containing JSON files to process\n\n    Returns:\n        pd.DataFrame: A DataFrame containing the data from all processed files\n    \"\"\"\n    # Create processed directory if it doesn't exist\n    processed_dir = os.path.join(path, 'processed')\n    os.makedirs(processed_dir, exist_ok=True)\n\n    # Get all JSON files in the directory, sorted alphabetically\n    json_files = sorted([f for f in os.listdir(path) if f.endswith('.json')])\n\n    # Initialize empty DataFrame to store all data\n    combined_df = pd.DataFrame()\n\n    for filename in json_files:\n        file_path = os.path.join(path, filename)\n\n        # Read JSON file\n        with open(file_path, 'r') as f:\n            data = json.load(f)\n\n        # Convert to DataFrame and add Source column\n        df = pd.DataFrame(data)\n        df['Source'] = filename\n\n        # Append to combined DataFrame\n        combined_df = pd.concat([combined_df, df], ignore_index=True)\n\n        # Move file to processed directory\n        shutil.move(file_path, os.path.join(processed_dir, filename))\n\n    return combined_df",
  "model": "mistral-3.2-24b"
}