{
  "task_id": "BigCodeBench/374",
  "instruct_prompt": "Protects all double quotes in all Excel (.xlsx) files in the specified directory by prefixing them with a double backslash.\nThe function should output with:\n    int: The number of Excel files processed.\nYou should write self-contained code starting with:\n```\nimport regex as re\nimport glob\nimport os\nfrom openpyxl import load_workbook\ndef task_func(directory_path='./xlsx_files/'):\n```",
  "llm_response": "import regex as re\nimport glob\nimport os\nfrom openpyxl import load_workbook\ndef task_func(directory_path='./xlsx_files/'):\n    \"\"\"\n    Protects all double quotes in all Excel (.xlsx) files in the specified directory by prefixing them with a double backslash.\n\n    Args:\n        directory_path (str): The path to the directory containing the Excel files. Defaults to './xlsx_files/'.\n\n    Returns:\n        int: The number of Excel files processed.\n    \"\"\"\n    # Initialize a counter for the number of Excel files processed\n    num_files_processed = 0\n\n    # Get a list of all Excel files in the specified directory\n    excel_files = glob.glob(os.path.join(directory_path, '*.xlsx'))\n\n    # Iterate over each Excel file\n    for file_path in excel_files:\n        # Load the Excel file using openpyxl\n        wb = load_workbook(filename=file_path)\n        ws = wb.active\n\n        # Iterate over each cell in the worksheet\n        for row in ws.iter_rows(values_only=True):\n            for cell_value in row:\n                if cell_value is not None and isinstance(cell_value, str):\n                    # Use regex to replace all double quotes with a double backslash followed by a double quote\n                    ws.cell(row=ws._current_row, column=ws._current_column).value = re.sub(r'\"', r'\\\"', cell_value)\n\n        # Save the modified Excel file\n        wb.save(file_path)\n\n        # Increment the counter for the number of Excel files processed\n        num_files_processed += 1\n\n    # Return the number of Excel files processed\n    return num_files_processed",
  "model": "llama-3.3-70b"
}